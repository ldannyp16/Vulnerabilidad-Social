########GRÁFICO SALUD###################
Departamento = factor(c(5,5,5,8,8,8,11,11,11,13,13,13,15,15,15,17,17,17,18,18,18,19,19,19,20,20,20,23,23,23,25,25,25,27,27,27,41,41,41,44,44,44,47,47,47,50,50,50,52,52,52,54,
54,54,63,63,63,66,66,66,68,68,68,70,70,70,73,73,73,76,76,76,81,81,81,85,85,85,86,86,86,88,88,88,91,91,91,94,94,94,95,95,95,97,97,97,99,99,99),labels=c("Antioquia","Atlántico",
"Distrito_Cap","Bolívar","Boyacá","Caldas","Caquetá","Cauca","Cesar","Córdoba","Cundinamarca","Chocó","Huila","Guajira","Magdalena","Meta","Nariño","N_Santander","Quidio",
"Risaralda","Santander","Sucre","Tolima","Valle_Cauca","Arauca","Casanare","Putumayo","San_Andrés","Amazonas","Guainía","Guaviare","Vaupés","Vichada"))

Régimen = factor(c(1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,
3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3),labels=c("Contributivo","Especial","Subsidiado"))

Participación = c(0.481708467,0.017348671,0.497454271,0.290144981,0.015507433,0.692879427,0.655381944,0.021329365,0.318824405,0.179222693,0.015656659,0.802726101,0.337087087,
0.029154154,0.632007007,0.399801149,0.025629695,0.5723597,0.142104709,0.020436111,0.834931002,0.212914679,0.021635416,0.76334184,0.196134417,0.019767186,0.781352954,0.154699476,
0.031060912,0.8129286,0.536379212,0.015648201,0.445916619,0.116691285,0.01874787,0.862288376,0.244114378,0.023441447,0.730625442,0.188753114,0.016490687,0.791790248,0.201755373,
0.019916732,0.774839653,0.372577904,0.029575071,0.596147309,0.146984925,0.027523984,0.82469164,0.243796816,0.026451311,0.728230337,0.468950504,0.024060495,0.505270394,
0.375180673,0.015486269,0.607268222,0.398266522,0.031852654,0.568255688,0.127015531,0.020674646,0.849045405,0.297191011,0.041460674,0.659550562,0.509230077,0.018009905,
0.471634399,0.140163778,0.013521234,0.844220149,0.25333114,0.025662115,0.719361737,0.103759837,0.023025357,0.871611775,0.684630102,0.020089286,0.294005102,0.148375116,
0.032497679,0.817827298,0.117411989,0.007992388,0.869457659,0.21224711,0.028540462,0.756141618,0.170390183,0.016677155,0.811516677,0.116119175,0.027119939,0.848166539)

df=data.frame(Departamento,Régimen,Participación) 
df
q <- ggplot(data=df, aes(x=Departamento, y=Participación, fill=Régimen)) + 
geom_bar(stat="identity") +
scale_fill_manual(values=c("goldenrod1", "yellow4","darkorange4"))
q + theme(axis.text.x = element_text(angle = 90, hjust = 1))                                    
      
prop.table(df, margin = 1)

########GRÁFICO PENSIÓN###############

Departamento = factor(c(5,8,11,13,15,17,18,19,20,23,25,27,41,44,47,50,52,54,63,66,68,70,73,76,81,85,86,88,91,94,95,97,99,5,8,11,13,15,17,18,19,20,23,25,27,41,44,47,50,52,54,
63,66,68,70,73,76,81,85,86,88,91,94,95,97,99),labels=c("Antioquia","Atlántico","Distrito_Cap","Bolívar","Boyacá","Caldas","Caquetá","Cauca","Cesar","Córdoba","Cundinamarca",
"Chocó","Huila","Guajira","Magdalena","Meta","Nariño","N_Santander","Quidio","Risaralda","Santander","Sucre","Tolima","Valle_Cauca","Arauca","Casanare","Putumayo","San_Andrés",
"Amazonas","Guainía","Guaviare","Vaupés","Vichada"))

Aportes = factor(c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2), labels=c("Sí","No"))
                   
Participación = c(0.417454614,0.22347163,0.295186299,0.177102874,0.37835943,0.323807647,0.005138453,0.421677983,0.310769544,0.299601901,0.234478996,0.244970662,0.250555309,
0.199953768,0.342132328,0.385898942,0.390125735,0.299965796,0.239769206,0.43161686,0.334341906,0.465909091,0.425531915,0.309891107,0.552312839,0.441728588,0.378776604,
0.312939852,0.336949846,0.427825501,0.187261588,0.284040309,0.307591623,0.582545386,0.77652837,0.704813701,0.825888569,0.62164057,0.676192353,0.994861547,0.578322017,
0.689230456,0.700398099,0.765521004,0.755029338,0.749444691,0.800046232,0.657867672,0.614101058,0.609874265,0.700034204,0.760230794,0.56838314,0.665658094,0.534090909,
0.574468085,0.690108893,0.447687161,0.558271412,0.621223396,0.687060148,0.663050154,0.572174499,0.812738412,0.715959691,0.692408377)

df=data.frame(Departamento,Aportes,Participación) 
df
q <- ggplot(data=df, aes(x=Departamento, y=Participación, fill=Aportes)) + 
  geom_bar(stat="identity") +
  scale_fill_manual(values=c("goldenrod1", "darkolivegreen4"))
q + theme(axis.text.x = element_text(angle = 90, hjust = 1))                                    

##########GRÁFICO ETNIA##########

Departamento = factor(c(5	,8	,11	,13	,15	,17	,18	,19	,20	,23	,25	,27	,41	,44	,47	,50	,52	,54	,63	,66	,68	,70	,73	,76	,81	,85	,86	,88	,91	,94	,95	,97	,99	,5	,8	,11	,13	,
15	,17	,18	,19	,20	,23	,25	,27	,41	,44	,47	,50	,52	,54	,63	,66	,68	,70	,73	,76	,81	,85	,86	,88	,91	,94	,95	,97	,99	,5	,8	,11	,13	,15	,17	,18	,19	,20	,23	,25	,27	,41	,44	,
47	,50	,52	,54	,63	,66	,68	,70	,73	,76	,81	,85	,86	,88	,91	,94	,95	,97	,99	,5	,8	,11	,13	,15	,17	,18	,19	,20	,23	,25	,27	,41	,44	,47	,50	,52	,54	,63	,66	,68	,70	,73	,76	,
81	,85	,86	,88	,91	,94	,95	,97	,99	,5	,8	,11	,13	,15	,17	,18	,19	,20	,23	,25	,27	,41	,44	,47	,50	,52	,54	,63	,66	,68	,70	,73	,76	,81	,85	,86	,88	,91	,94	,95	,97	,99),
labels=c("Antioquia","Atlántico","Distrito_Cap","Bolívar","Boyacá","Caldas","Caquetá","Cauca","Cesar","Córdoba","Cundinamarca","Chocó","Huila","Guajira","Magdalena","Meta",
"Nariño","N_Santander","Quidio","Risaralda","Santander","Sucre","Tolima","Valle_Cauca","Arauca","Casanare","Putumayo","San_Andrés","Amazonas","Guainía","Guaviare","Vaupés",
"Vichada"))

Etnia = factor(c(1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	2,	2,	2,	2,	2,	2,
2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,
3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,
4,	4,	4,	4,	4,	4,	4,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5),
labels=c("Indígena","Gitano","Raizal","Palenquero","Afrodes/te"))

Participación = c(0.01,	0.14,	0.75,	0.35,	0.37,	0.24,	0.09,	0.69,	0.62,	0.48,	0.78,	0.81,	0.17,	0.14,	0.49,	0.34,	0.98,	0.51,	0.77,	0.20,	1.00,	0.98,	0.97,	0.22,	0.11,	0.99,
0.82,	0.37,	0.54,	0.45,	0.21,	0.16,	0.00,	0.00,	0.00,	0.00,	0.02,	0.00,	0.00,	0.00,	0.00,	0.00,	0.02,	0.00,	0.00,	0.00,	0.00,	0.00,	0.00,	0.00,	0.00,	0.00,	0.00,	0.00,	0.00,
0.00,	0.00,	0.00,	0.00,	0.00,	0.00,	0.05,	0.00,	0.01,	0.00,	0.00,	0.00,	0.00,	0.00,	0.02,	0.00,	0.00,	0.00,	0.00,	0.00,	0.01,	0.00,	0.00,	0.06,	0.00,	0.00,	0.01,	0.00,	0.00,
0.00,	0.00,	0.00,	0.00,	0.00,	0.00,	0.00,	0.00,	0.00,	0.01,	0.00,	0.00,	0.00,	0.02,	0.47,	0.01,	0.19,	0.00,	0.02,	0.00,	0.00,	0.00,	0.00,	0.00,	0.00,	0.00,	0.00,	0.01,	0.00,
0.00,	0.00,	0.00,	0.00,	0.00,	0.00,	0.00,	0.00,	0.00,	0.00,	0.00,	0.00,	0.00,	0.01,	0.01,	0.00,	0.01,	0.00,	0.03,	0.98,	0.67,	0.25,	0.59,	0.63,	0.76,	0.91,	0.31,	0.38,	0.49,
0.22,	0.19,	0.76,	0.86,	0.51,	0.65,	0.02,	0.49,	0.23,	0.80,	0.00,	0.02,	0.03,	0.78,	0.89,	0.01,	0.18,	0.61,	0.40,	0.55,	0.77,	0.82,	0.50)

df=data.frame(Departamento,Etnia,Participación) 
df
q <- ggplot(data=df, aes(x=Departamento, y=Participación, fill=Etnia)) + 
  geom_bar(stat="identity") +
  scale_fill_manual(values=c("goldenrod1", "darkolivegreen4", "darkgreen", "darkorange","darkorange4"))
q + theme(axis.text.x = element_text(angle = 90, hjust = 1))  

##########GRÁFICO VIVIENDA##########

Departamento = factor(c(5	,8	,11	,13	,15	,17	,18	,19	,20	,23	,25	,27	,41	,44	,47	,50	,52	,54	,63	,66	,68	,70	,73	,76	,81	,85	,86	,88	,91	,94	,95	,97	,99	,5	,8	,11	,13	,15	,
17	,18	,19	,20	,23	,25	,27	,41	,44	,47	,50	,52	,54	,63	,66	,68	,70	,73	,76	,81	,85	,86	,88	,91	,94	,95	,97	,99	,5	,8	,11	,13	,15	,17	,18	,19	,20	,23	,25	,27	,41	,44	,47	,50	,
52	,54	,63	,66	,68	,70	,73	,76	,81	,85	,86	,88	,91	,94	,95	,97	,99	,5	,8	,11	,13	,15	,17	,18	,19	,20	,23	,25	,27	,41	,44	,47	,50	,52	,54	,63	,66	,68	,70	,73	,76	,81	,85	,86	,
88	,91	,94	,95	,97	,99	,5	,8	,11	,13	,15	,17	,18	,19	,20	,23	,25	,27	,41	,44	,47	,50	,52	,54	,63	,66	,68	,70	,73	,76	,81	,85	,86	,88	,91	,94	,95	,97	,99	,5	,8	,11	,13	,15	,
17	,18	,19	,20	,23	,25	,27	,41	,44	,47	,50	,52	,54	,63	,66	,68	,70	,73	,76	,81	,85	,86	,88	,91	,94	,95	,97	,99),labels=c("Antioquia","Atlántico","Distrito_Cap","Bolívar",
"Boyacá","Caldas","Caquetá","Cauca","Cesar","Córdoba","Cundinamarca","Chocó","Huila","Guajira","Magdalena","Meta","Nariño","N_Santander","Quidio","Risaralda","Santander",
"Sucre","Tolima","Valle_Cauca","Arauca","Casanare","Putumayo","San_Andrés","Amazonas","Guainía","Guaviare","Vaupés","Vichada"))

Vivienda = factor(c(1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	1,	2,	2,	2,	2,	2,	2,
2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	2,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,
3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	3,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,	4,
4,	4,	4,	4,	4,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5,	5, 6	,6	,6	,6	,6	,6	,
6	,6	,6	,6	,6	,6	,6	,6	,6	,6	,6	,6	,6	,6	,6	,6	,6	,6	,6	,6	,6	,6	,6	,6	,6	,6	,6), labels=c("Prop_paga","Prop_en_pago","Arriendo","Usufructo",
"Ocup_hecho","Prop_colectiva"))

Participación = c(0.509411413,	0.466908133,	0.377094972,	0.457563313,	0.546469622,	0.424544666,	0.460062472,	0.307971014,	0.557966321,	0.358508914,	0.394831731,
0.505936073,	0.417860408,	0.407923244,	0.556167044,	0.342556391,	0.44068287,	0.421565641,	0.379637378,	0.475878986,	0.241591928,	0.558859223,	0.306818182,
0.421694915,	0.655633567,	0.246402878,	0.438259506,	0.455122393,	0.580123796,	0.46126447,	0.526785714,	0.390009308,	0.580487805,	0.007170601,	0.036878499,
0.023277467,	0.029774127,	0.033825944,	0.00650477,	0.035698349,	0.009222661,	0.01392487,	0.06904376,	0.021935096,	0.039269406,	0.042669918,	0.053543794,
0.022984785,	0.030676692,	0.035590278,	0.047212915,	0.022594142,	0.033524121,	0.002242152,	0.003033981,	0.006714876,	0.023389831,	0.003009027,	0.008393285,
0.01372011,	0.01087942,	0.004470426,	0.021371327,	0.01860119,	0.04529941,	0.007317073,	0.170600538,	0.29107672,	0.320918684,	0.243326489,	0.213136289,	0.246747615,
0.262382865,	0.234189723,	0.139572539,	0.397082658,	0.258112981,	0.23196347,	0.299603779,	0.304549675,	0.171900291,	0.308270677,	0.243923611,	0.26652452,
0.286750349,	0.312891796,	0.161434978,	0.086771845,	0.231921488,	0.219661017,	0.163490471,	0.181654676,	0.273226186,	0.183741312,	0.133425034,	0.307658059,
0.177455357,	0.339435309,	0.343089431,	0.206154765,	0.170233783,	0.243947858,	0.23613963,	0.19047619,	0.245880312,	0.211512718,	0.247694335,	0.247733161,
0.125769854,	0.271033654,	0.187214612,	0.190795489,	0.193129062,	0.186144383,	0.300150376,	0.209780093,	0.221748401,	0.260808926,	0.142000545,	0.075112108,
0.067961165,	0.152892562,	0.281694915,	0.130391174,	0.079136691,	0.259506076,	0.288909036,	0.232118294,	0.177203918,	0.217633929,	0.196090599,	0.051219512,
0.086047206,	0.020744155,	0.02141527,	0.029774127,	0.01182266,	0.069817866,	0.029004909,	0.05171278,	0.023963731,	0.033711507,	0.043569712,	0.019482496,
0.027735447,	0.025998143,	0.031401748,	0.011428571,	0.032118056,	0.019189765,	0.027057183,	0.016625784,	0.091367713,	0.009101942,	0.255681818,	0.050508475,
0.018388499,	0.135491607,	0.014504116,	0.032940465,	0.040921596,	0.023597507,	0.042782738,	0.020167546,	0.010569106,	0.020615477,	0.014158709,	0.013345748,
0.003422313,	0.004269294,	0.00650477,	0.001338688,	0.149209486,	0.016839378,	0.015883306,	0.010516827,	0.016133942,	0.021334959,	0.014856082,	0.031401748,
0.006917293,	0.037905093,	0.023758757,	0.023152022,	0.019078768,	0.428251121,	0.274271845,	0.045971074,	0.003050847,	0.029087262,	0.348920863,	0.000784006,
0.028407374,	0.008940853,	0.00890472,	0.016741071,	0.008997828,	0.007317073) 

df=data.frame(Departamento,Vivienda,Participación) 
df
q <- ggplot(data=df, aes(x=Departamento, y=Participación, fill=Vivienda)) + 
  geom_bar(stat="identity") +
  scale_fill_manual(values=c("goldenrod1", "darkolivegreen4", "yellow4", "darkgreen", "darkorange","darkorange4"))
q + theme(axis.text.x = element_text(angle = 90, hjust = 1))  

########piechart##############
#librería
library(ggplot2)

#crear datos
data <- data.frame(
  Calidad = c("Muy buena","Buena","Mala","Muy mala"),
  count = c(0.05544804,0.770938256,0.145712378,0.027901327))


#calcular porcentajes
data$fraction = data$count / sum(data$count)

#calcular el porcentaje acumulado
data$ymax = cumsum(data$fraction)

#calcular la parte interior de cada rectángulo
data$ymin = c(0, head(data$ymax, n=-1))

#graficar
ggplot(data, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=Calidad)) +
  geom_rect() +
  coord_polar(theta="y") +
  scale_fill_manual(values=c("goldenrod1", "yellow4","darkorange4","yellow")) +
  xlim(c(2, 4))
